# KMZI_EXAM

Задание 4. 
Итерационный шифр F = F_3 ◦ F_2 ◦ F_1 является SP-сетью с информационным блоком длины 8.
Информационный блок р(0) - открытый текст, информационный блок p(i), і≥I - выход i-го цикла
шифрования, информационный блок р(3) - шифртекст.
Первые два цикла шифрования действуют следующим образом: 
(1) информационный блок побитно складывается с цикловым ключом; 
(2) полученный вектор разбивается на 2 равные части по 4 бита и каждая из них поступает на вход S-блока; 
(3) выходы S-блоков объединяются в один вектор длины 8 и пропускаются через Р-блок. Третий цикл шифрования состоит только из побитного сложения с
цикловым ключом.
S-блок: (15, 12, 8, 2, 4, 9, 1, 7, 5, 11, 3, 14, 10, 0, 6, 13), Р-блок: (1, 8, 3, 5, 7, 4, 6, 2), цикловые ключи: k(1)=10101010, k(2)=11111111, k(3)=01010101.
a) Дать полное описание алгоритма расшифрования.
б) Пусть шифртекст с = p(3) = 01011000. Найти открытый текст и все информационные блоки p(i).

Решение:

Шифртекст: 01011000

Шаг 1: Применение третьего цикла
p(2) = c ⊕ k(3)
Выполняем побитовый XOR между 01011000 и 01010101:
0 ⊕ 0 = 0
1 ⊕ 1 = 0
0 ⊕ 0 = 0
1 ⊕ 1 = 0
1 ⊕ 0 = 1
0 ⊕ 1 = 1
0 ⊕ 0 = 0
0 ⊕ 1 = 1
Итоговый результат XOR: 00001101

Шаг 2: Применение второго цикла
p(2) после P-блока: p(2) = P^(-1)(p(2))
Обратный P-блок: 00001101 -> 10110000
p(1) после S-блока: p(1) = S^(-1)(p(2))
Обратный S-блок: 10110000 -> 11011110
p(0) = p(1) ⊕ k(2)
Выполняем побитовый XOR между 11011110 и 11111111:
1 ⊕ 1 = 0
1 ⊕ 1 = 0
0 ⊕ 1 = 1
1 ⊕ 1 = 0
1 ⊕ 1 = 0
1 ⊕ 1 = 0
1 ⊕ 1 = 0
0 ⊕ 1 = 1
Итоговый результат XOR: 00100001

Шаг 3: Применение первого цикла
plaintext = p(0) ⊕ k(1)
Выполняем побитовый XOR между 00100001 и 10101010:
0 ⊕ 1 = 1
0 ⊕ 0 = 0
1 ⊕ 1 = 0
0 ⊕ 0 = 0
0 ⊕ 1 = 1
0 ⊕ 0 = 0
0 ⊕ 1 = 1
1 ⊕ 0 = 1
Итоговый результат XOR: 10001011

Открытый текст: 10001011

